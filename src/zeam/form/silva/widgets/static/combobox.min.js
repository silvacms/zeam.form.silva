(function($,infrae){var create_combobox_field=function(){var $field=$(this),$select=$field.children("select"),$input=$field.children("input.combobox-input"),$opener=$field.children("a.combobox-opener"),selected=$select.children(":selected"),value=selected.text();$input.val(value).autocomplete({delay:0,minLength:0,source:function(request,response){var matcher=RegExp($.ui.autocomplete.escapeRegex(request.term),"i");response($select.children("option").map(function(){var $option=$(this),text=$option.text();return!request.term||matcher.test(text)?{label:text.replace(RegExp("(?![^&;]+;)(?!<[^<>]*)("+$.ui.autocomplete.escapeRegex(request.term)+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>"),icon:$option.data("combobox-icon"),value:text,option:this}:void 0}))},select:function(event,ui){ui.item.option.selected=!0,value=ui.item.value},change:function(event,ui){if(!ui.item){var valid=!1,matcher=RegExp("^"+$.ui.autocomplete.escapeRegex($(this).val())+"$","i");if($select.children("option").each(function(){var $option=$(this);return $option.text().match(matcher)?(this.selected=valid=!0,!1):void 0}),!valid)return $(this).val(value),$select.val(value),$input.data("autocomplete").term=value,!1}}}),$input.data("autocomplete")._resizeMenu=function(){var $ul=this.menu.element;$ul.outerWidth(Math.max($ul.width("").outerWidth()+40,this.element.outerWidth()))},$input.data("autocomplete")._renderItem=function(ul,item){var $item=$("<li><a>"+item.label+"</a></li>");if(item.icon){var $icon=$('<ins class="icon" />');infrae.ui.icon($icon,item.icon),$item.prepend($icon)}return $item.data("item.autocomplete",item).appendTo(ul)},$input.autocomplete("widget").zIndex($input.zIndex()+1),$opener.click(function(){return $input.autocomplete("widget").is(":visible")?($input.autocomplete("close"),void 0):($opener.blur(),$input.autocomplete("search",""),$input.focus(),void 0)})};$(document).on("loadwidget-smiform",".form-fields-container",function(event){$(this).find(".field-combobox").each(create_combobox_field),event.stopPropagation()})})(jQuery,infrae);